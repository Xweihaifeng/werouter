<#extend#>public/domain/domain_extend.html</#extend#>

<link rel="stylesheet" href="/resource/wetpl/default/wap/css/article.css">
<div class="latest">最新推荐</div>
<div id="container" class="my_container">
	<div>
		<li v-for="item in list">{{item.title}}
			<br/><br/><br/><br/><br/><br/><br/><br/>
		</li>
	</div>
	
</div>

<script type="text/javascript">
	new Vue({
    	el: '#app',
    	data : {
    		list:[],
    		page : 1,
    		limit : 10,
    		page_count : 0,
    		type : 1,
    		dynamic_type : 0,
    	},
        mounted() {
        	this.$nextTick(()=>{
        		$('#container').dropload({
        			scrollArea : window,
        			loadDownFn : (dropload)=>{
        				this.data_list(dropload);
        				this.page++;
        			}
        		});
        	});
        },
        methods:{
        	data_list(dropload) {
        		$mob_ajax.dynamic(this.type , this.dynamic_type , this.page , this.limit ,  (res)=>{

        			 setTimeout(()=>{
        			 	this.list = this.list.concat(res.data.list);
                        // 插入数据到页面，放到最后面
                        dropload.resetload();
                    },1000);

        			if(res == false)
        			{
        				// dropload.resetload();
        				// 锁定
                        dropload.lock();
                        // 无数据
                        dropload.noData();
                        return false;
        			}
        			
					if(res.data.params.pageCount == res.data.params.currPage)
        			{
        				dropload.lock();

        				dropload.noData();
        				return false;
        			}
        			
        		});
        	}
        }
    });
</script>