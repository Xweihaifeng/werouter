<#extend#>public/coc/coc_extend.html</#extend#>

<link rel="stylesheet" href="{{PATH_TML}}views/css/Plat.news.detail.css">
<script type="text/javascript">
    show.header = 'no';
    if($app.get_query_string('from') == 'weplats') {
          show.header = 'no';
          // show.foorer = 'no';
    }
</script>

<div class="clear"></div>
<div id="read" style="background-color:#fff">
    <div class="read-title">
        <p class="title" v-html="news_detail.title"></p>
    </div>
    <div class="auth-info">
        <div class="auth-original" style="" v-if="news_detail.is_original == 1">原创</div>
        <div class="auth-date">{{news_detail.publish_time}}</div>
        <div class="auth-name" style="display: none;"></div>
        <div class="auth-publisher" style="margin-right: 0.08rem;" v-html="news_detail.publisher"></div>
        <div class="auth-main">
            <a href="/kezunping/wecard/" style="color: #607fa6; text-decoration: none;" v-html="news_detail.auth"></a>
        </div>
    </div>
    <div id="read-art" v-html="news_detail.content"></div>
    <div id="footer">
        <div class="read-org" style="">
            <a :href="news_detail.source_url">阅读原文</a>
        </div>
        <div class="read-count">阅读 <span>{{news_detail.views}}</span></div>
        <div class="read-like" @click="zan()">
            <img src="/common/img/like.png" alt="" />
            <span class="like-count">{{news_detail.praise_num}}</span>
        </div>
        <div class="read-complain">投诉</div>
    </div>
</div>
<script>
    var app = new Vue({
        el: '#app',
        data: {
            news_detail: {},
            category : '',
            zan_true : '',
            plats_info: plats_info,
            id : window.location.pathname.split('/').pop()
        },
        mounted: function() {
            ajax.get('cms/detail/'+this.id).then((res) => {
                if (res.data && res.code === 200) {
                    console.log(res.data);
                    this.news_detail = res.data;
                    this.category = res.data.category;
                    plats.title = res.data.category.title;
                    $app.set_title(this.news_detail.title);
                }
            });
        },
        methods: {
            zan(){
                var data = new Object();
                data.content_id = this.news_detail.weid;
                ajax.post('cms/contents/praise', data).then((res) => {
                    if (res.data && res.code === 200) {
                        this.zan_true = res.data.praise;
                        if(!this.zan_true) {
                            mb_message('已经点赞过了');
                            return false;
                        }
                        mb_message('点赞成功');
                    }
                });
            }
        }
    })
</script>