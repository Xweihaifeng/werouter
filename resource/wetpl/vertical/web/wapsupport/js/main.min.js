function Base64(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.encode=function(o){var r,a,n,i,c,s,l,d="",u=0;for(o=t(o);u<o.length;)r=o.charCodeAt(u++),a=o.charCodeAt(u++),n=o.charCodeAt(u++),i=r>>2,c=(3&r)<<4|a>>4,s=(15&a)<<2|n>>6,l=63&n,isNaN(a)?s=l=64:isNaN(n)&&(l=64),d=d+e.charAt(i)+e.charAt(c)+e.charAt(s)+e.charAt(l);return d},this.decode=function(t){var r,a,n,i,c,s,l,d="",u=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<t.length;)i=e.indexOf(t.charAt(u++)),c=e.indexOf(t.charAt(u++)),s=e.indexOf(t.charAt(u++)),l=e.indexOf(t.charAt(u++)),r=i<<2|c>>4,a=(15&c)<<4|s>>2,n=(3&s)<<6|l,d+=String.fromCharCode(r),64!=s&&(d+=String.fromCharCode(a)),64!=l&&(d+=String.fromCharCode(n));return d=o(d)};var t=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",o=0;o<e.length;o++){var r=e.charCodeAt(o);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},o=function(e){for(var t="",o=0,r=c1=c2=0;o<e.length;)r=e.charCodeAt(o),r<128?(t+=String.fromCharCode(r),o++):r>191&&r<224?(c2=e.charCodeAt(o+1),t+=String.fromCharCode((31&r)<<6|63&c2),o+=2):(c2=e.charCodeAt(o+1),c3=e.charCodeAt(o+2),t+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),o+=3);return t}}!function(e){function t(e){return c.raw?e:encodeURIComponent(e)}function o(e){return c.raw?e:decodeURIComponent(e)}function r(e){return t(c.json?JSON.stringify(e):String(e))}function a(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(i," ")),c.json?JSON.parse(e):e}catch(t){}}function n(t,o){var r=c.raw?t:a(t);return e.isFunction(o)?o(r):r}var i=/\+/g,c=e.cookie=function(a,i,s){if(void 0!==i&&!e.isFunction(i)){if(s=e.extend({},c.defaults,s),"number"==typeof s.expires){var l=s.expires,d=s.expires=new Date;d.setTime(+d+864e5*l)}return document.cookie=[t(a),"=",r(i),s.expires?"; expires="+s.expires.toUTCString():"",s.path?"; path="+s.path:"",s.domain?"; domain="+s.domain:"",s.secure?"; secure":""].join("")}for(var u=a?void 0:{},f=document.cookie?document.cookie.split("; "):[],m=0,p=f.length;p>m;m++){var h=f[m].split("="),v=o(h.shift()),g=h.join("=");if(a&&a===v){u=n(g,i);break}a||void 0===(g=n(g))||(u[v]=g)}return u};c.defaults={},e.removeCookie=function(t,o){return void 0!==e.cookie(t)&&(e.cookie(t,"",e.extend({},o,{expires:-1})),!e.cookie(t))}}(jQuery),function(e){function t(){try{return c in e&&e[c]}catch(t){return!1}}function o(e){return function(){var t=Array.prototype.slice.call(arguments,0);t.unshift(a),s.appendChild(a),a.addBehavior("#default#userData"),a.load(c);var o=e.apply(n,t);return s.removeChild(a),o}}function r(e){return e.replace(u,"___")}var a,n={},i=e.document,c="localStorage";if(n.disabled=!1,n.set=function(e,t){},n.get=function(e){},n.remove=function(e){},n.clear=function(){},n.transact=function(e,t,o){var r=n.get(e);null==o&&(o=t,t=null),"undefined"==typeof r&&(r=t||{}),o(r),n.set(e,r)},n.getAll=function(){},n.forEach=function(){},n.serialize=function(e){return JSON.stringify(e)},n.deserialize=function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e||void 0}},t())a=e[c],n.set=function(e,t){return void 0===t?n.remove(e):(a.setItem(e,n.serialize(t)),t)},n.get=function(e){return n.deserialize(a.getItem(e))},n.remove=function(e){a.removeItem(e)},n.clear=function(){a.clear()},n.getAll=function(){var e={};return n.forEach(function(t,o){e[t]=o}),e},n.forEach=function(e){for(var t=0;t<a.length;t++){var o=a.key(t);e(o,n.get(o))}};else if(i.documentElement.addBehavior){var s,l;try{l=new ActiveXObject("htmlfile"),l.open(),l.write('<script>document.w=window</script><iframe src="/favicon.ico"></iframe>'),l.close(),s=l.w.frames[0].document,a=s.createElement("div")}catch(d){a=i.createElement("div"),s=i.body}var u=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");n.set=o(function(e,t,o){return t=r(t),void 0===o?n.remove(t):(e.setAttribute(t,n.serialize(o)),e.save(c),o)}),n.get=o(function(e,t){return t=r(t),n.deserialize(e.getAttribute(t))}),n.remove=o(function(e,t){t=r(t),e.removeAttribute(t),e.save(c)}),n.clear=o(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(c);for(var o,r=0;o=t[r];r++)e.removeAttribute(o.name);e.save(c)}),n.getAll=function(e){var t={};return n.forEach(function(e,o){t[e]=o}),t},n.forEach=o(function(e,t){for(var o,r=e.XMLDocument.documentElement.attributes,a=0;o=r[a];++a)t(o.name,n.deserialize(e.getAttribute(o.name)))})}try{var f="__storejs__";n.set(f,f),n.get(f)!=f&&(n.disabled=!0),n.remove(f)}catch(d){n.disabled=!0}n.enabled=!n.disabled,"undefined"!=typeof module&&module.exports?module.exports=n:"function"==typeof define&&define.amd?define(n):e.store=n,e.qscBaseStore=n}(window||global),window.qscBase64=new Base64,function(e){"use strict";function t(){var e=location.search,t=new Object;if(e.indexOf("?")!=-1)for(var o=e.substr(1),r=o.split("&"),a=0;a<r.length;a++)t[r[a].split("=")[0]]=r[a].split("=")[1];return t}function o(){var o=t(),r=o.qsctoken;if(r){var a=window.qscBase64.decode(window.decodeURIComponent(r));null!=e.cookie("Qsc-Token")&&null!=e.cookie("Qsc-Token-All")||(e.cookie("Qsc-Token",null,{expires:-1}),e.cookie("Qsc-Token-All",null,{expires:-1}));try{var n=JSON.parse(a);window.qscBaseStore.set("Qsc-Token",a),e.cookie("Qsc-Token",n.access_token,{expires:365,path:"/",domain:"qschou.com"}),e.cookie("Qsc-Token-All",a,{expires:365,path:"/",domain:"qschou.com"});var i=window.location.href,c=i.indexOf("qsctoken=");i=i.substr(0,c-1),location.replace(i)}catch(s){window.qscBaseStore.remove("Qsc-Token"),e.cookie("Qsc-Token",null,{expires:-1}),e.cookie("Qsc-Token-All",null,{expires:-1})}}else{var l=window.qscBaseStore.get("Qsc-Token");try{JSON.parse(l)}catch(s){window.qscBaseStore.remove("Qsc-Token"),e.cookie("Qsc-Token",null,{expires:-1}),e.cookie("Qsc-Token-All",null,{expires:-1})}}}function r(e){window&&window.console&&window.console.log("$.qscAjax: ",e)}function a(e){var t=window.qscBaseStore.get(n);try{t=JSON.parse(t)}catch(o){}return e.headers||(e.headers={}),e.headers[n]=t?t.access_token||"":"",e.headers[i]=c,e}window.APIBasePath="https://gateway.qschou.com/v2.5.1/",window.qscLoginBaseURL="https://passport.qschou.com/login.html?redirect_uri=";var n="Qsc-Token",i="Platform",c="qsc_h5";o(),e.qscAjax=function(t){var o={};return"string"==typeof t&&""!==t?(o.url=t,o=a(o),e.ajax(o)):e.isPlainObject(t)?(o=t,o=a(o),e.ajax(o)):(r("The arguments is illegal. A non-empty string or an object is expected!"),e.ajax(t))}}(jQuery),$(function(){function e(){var e=location.href,t=e.indexOf("index/"),o=0;return t!=-1&&(o=e.substr(t+6,36)),o}function t(){var e=location.search,t=new Object;if(e.indexOf("?")!=-1)for(var o=e.substr(1),r=o.split("&"),a=0;a<r.length;a++)t[r[a].split("=")[0]]=r[a].split("=")[1];return t}function o(e,t){"string"!=typeof e&&(e=""),"string"!=typeof t&&(t=""),e=e.toString().split("."),t=t.toString().split(".");for(var o=0;o<e.length||o<t.length;o++){var r=parseInt(e[o],10),a=parseInt(t[o],10);if(isNaN(r)&&(r=0),isNaN(a)&&(a=0),r<a)return-1;if(r>a)return 1}return 0}function r(e){var t="系统繁忙,请稍后重试";e&&e.msg&&(t=e.msg),alert(t)}function a(e){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",location.protocol+"//static2.qschou.com/css/v6/project/detail/"+e+".css?r=20170918"),document.getElementsByTagName("head")[0].appendChild(t);var o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("data-main",location.protocol+"//static2.qschou.com/js/v6/project/detail/"+e+".min.js?r=20170918"),o.setAttribute("src",location.protocol+"//static2.qschou.com/js/libs/require-2.2.0.min.js"),document.getElementsByTagName("body")[0].appendChild(o)}var n=(location.origin.replace("m","project"),"");location.host.indexOf("qschou.com")!=-1&&(n=e());var i=APIBasePath+"project/index/auth2/"+n;location.host.indexOf("qschou.com")==-1&&(i="mock/auth"),$.qscAjax({type:"get",url:i,dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,cache:!1}).done(function(e){function i(e){var t=location.search,o=location.hash;e+=t?"?projuuid="+encodeURIComponent(n)+"&"+location.search.substr(1):"?projuuid="+encodeURIComponent(n),o&&(e+=o),location.replace(e)}if(0===e.code&&e.data){e.data.project_uuid=n,"sale"===e.data.template?e.data.template=8:"dream"===e.data.template?e.data.template=9:"love"===e.data.template?e.data.template=11:"cross"===e.data.template&&(e.data.template=30),e.data.manager=e.data.is_manager,e.data.project_follow=e.data.is_follow,e.data.share_number=parseInt(e.data.share_number,10),e.data.state=parseInt(e.data.state,10),e.data.active=parseInt(e.data.active,10),e.data.new_verify_state=parseInt(e.data.verify_state,10),e.data.verify_state=parseInt(e.data.old_verify_state,10),window.auth={};for(var c in e.data)e.data.hasOwnProperty(c)&&"is_manager"!=c&&"old_verify_state"!=c&&"is_follow"!=c&&(window.auth[c]=e.data[c]);var s=t(),l=s.type,d=s.platform;d&&(window.auth.platform=d);var u=s.shareto;if(u&&(window.auth.shareto=u),l)a(l);else if(8===e.data.template)a("sale"),$(".J-app-banner-link").show();else if(9===e.data.template)a("dream"),$(".J-app-banner-link").show();else if(11===e.data.template){var f=o(e.data.version,"3.0.0")>=0;if(3349==e.data.category_id||0==e.data.category_id)if(f){var m="https://m2.qschou.com/project/love/love_v7.html";i(m)}else a("sick"),$(".J-app-banner-link").show();else if(3362==e.data.category_id)a("student");else if(f){var m="https://m2.qschou.com/project/loveother/loveother_v7.html";i(m)}else a("qsccommonweal"),$(".J-app-banner-link").show()}else if(30===e.data.template)if(3362==e.data.category_id){var m="https://m2.qschou.com/project/commonweal/commonweal_v7.html";i(m)}else a("commonweal");else r(e)}else r(e)}).fail(function(e){$("#toast-loading").length&&$("#toast-loading").hide();/*var t="系统繁忙,请稍后重试";e.responseJSON&&e.responseJSON.error&&(t=e.responseJSON.error),alert(t)*/})});